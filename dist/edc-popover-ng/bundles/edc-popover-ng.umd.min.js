!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("edc-client-js"),require("@ngx-translate/core"),require("@angular/common"),require("ngx-bootstrap/popover"),require("@angular/common/http"),require("rxjs"),require("rxjs/operators")):"function"==typeof define&&define.amd?define("edc-popover-ng",["exports","@angular/core","edc-client-js","@ngx-translate/core","@angular/common","ngx-bootstrap/popover","@angular/common/http","rxjs","rxjs/operators"],t):t((e=e||self)["edc-popover-ng"]={},e.ng.core,e.edcClientJs,e.core$1,e.ng.common,e.popover,e.ng.common.http,e.rxjs,e.rxjs.operators)}(this,function(e,t,n,o,r,i,l,a,p){"use strict";function s(e,t,n,o){var r,i=arguments.length,l=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(l=(i<3?r(l):i>3?r(t,n,l):r(t,n))||l);return i>3&&l&&Object.defineProperty(t,n,l),l}function c(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}var u=function(){},d="en",g={en:{labels:{articles:"Need more...",links:"Related topics"}},fr:{labels:{articles:"Plus d'info...",links:"Sujets associés"}},ru:{labels:{articles:"Подробнее...",links:"Связанные темы"}},vi:{labels:{articles:"Đọc thêm...",links:"Liên quan"}},zh:{labels:{articles:"需要更多...",links:"相关话题"}}},h=function(){function e(e){this.configurationHandler=e,this.edcClient=new n.EdcClient(e.getDocPath(),e.getHelpPath(),e.getPluginId(),!0,e.getI18nPath())}return e.prototype.getHelp=function(e,t,n,o){var r=n||this.configurationHandler.getPluginId();return this.edcClient.getHelper(e,t,r,o)},e.prototype.getContextUrl=function(e,t,n,o,r){return this.edcClient.getContextWebHelpUrl(e,t,n,o,r)},e.prototype.getDocumentationUrl=function(e){return this.edcClient.getDocumentationWebHelpUrl(e)},e.prototype.getI18nUrl=function(){return this.edcClient.getPopoverI18nUrl()},e.prototype.getPluginId=function(){return this.configurationHandler.getPluginId()},e.prototype.getIcon=function(){return this.configurationHandler.getIcon()||"fa-question-circle-o"},e.prototype.getContainer=function(){return this.configurationHandler.isAppendToBody()?"body":""},e.prototype.getDefaultLanguage=function(){return this.edcClient&&this.edcClient.getDefaultLanguage&&this.edcClient.getDefaultLanguage()||d},e.prototype.isLanguagePresent=function(e){return this.edcClient.isLanguagePresent(e)},e=s([t.Injectable(),c("design:paramtypes",[u])],e)}(),f=function(){function e(){}return e.MESSAGE_COMING_SOON="Contextual help is coming soon.",e}(),v=function(){function e(e,t){this.helpService=e,this.translateService=t,this.comingSoon=f.MESSAGE_COMING_SOON,this.placement="bottom"}return e.prototype.ngOnInit=function(){this.langLoading===undefined&&this.initHelper(),this.translateService.setDefaultLang(d),this.iconCss=this.helpService.getIcon(),this.container=this.helpService.getContainer()},e.prototype.ngOnChanges=function(e){e.lang&&e.lang.currentValue!==this.langLoading&&this.initHelper()},e.prototype.initHelper=function(){this.key&&this.subKey&&(this.langLoading=this.lang||null,this.helper?this.loadHelper():setTimeout(this.loadHelper.bind(this),2e3))},e.prototype.loadHelper=function(){var e=this;this.helpService.getHelp(this.key,this.subKey,this.pluginId,this.lang).then(function(t){if(!t)throw new Error("Could not load Helper for the key "+e.key+" and subKey "+e.subKey);e.helper=t;var n=t.language;n!==e.lang&&(e.lang=n,console.warn("Requested language "+e.lang+" could not be loaded,\n           content will be using default language "+t.language+" instead")),e.translateService.use(e.lang),e.langLoading=null})["catch"](function(t){console.error(t),e.langLoading=null})},e.prototype.goToArticle=function(e){var t=this.helpService.getContextUrl(this.key,this.subKey,this.lang,e);this.open(t)},e.prototype.goToLink=function(e){var t=this.helpService.getDocumentationUrl(e.id);this.open(t)},e.prototype.getPlacement=function(){return this.placement},e.prototype.cancelClick=function(e){e.preventDefault()},e.prototype.open=function(e){window.open(e,"help","scrollbars=1,resizable=1,height=800,width=1200")},s([t.Input(),c("design:type",String)],e.prototype,"pluginId",void 0),s([t.Input(),c("design:type",String)],e.prototype,"key",void 0),s([t.Input(),c("design:type",String)],e.prototype,"subKey",void 0),s([t.Input(),c("design:type",Object)],e.prototype,"placement",void 0),s([t.Input(),c("design:type",Boolean)],e.prototype,"dark",void 0),s([t.Input(),c("design:type",String)],e.prototype,"lang",void 0),e=s([t.Component({selector:"edc-help",template:'\n    \x3c!-- Popover template --\x3e\n    <ng-template #popTemplate>\n      <div class="edc-popover-container" (click)="$event.stopPropagation()">\n        <article class="popover-article">{{ helper?.description }}</article>\n        <div class="see-also">\n          <div *ngIf="helper?.articles.length">\n            <h6><strong><span>{{ \'labels.articles\' | translate }}</span></strong></h6>\n            <ul class="see-also-list">\n              <li *ngFor="let article of helper.articles; let key = index" class="see-also-item"\n                  (click)="goToArticle(key)">\n                <div class="article-link">{{article.label}}</div>\n              </li>\n            </ul>\n          </div>\n          <div *ngIf="helper?.links.length">\n            <h6><strong><span>{{ \'labels.links\' | translate }}</span></strong></h6>\n            <ul class="see-also-list">\n              <li *ngFor="let link of helper.links" class="see-also-item" (click)="goToLink(link)">\n                <div class="article-link">{{link.label}}</div>\n              </li>\n            </ul>\n          </div>\n        </div>\n      </div>\n    </ng-template>\n\n\n    \x3c!-- app-help template --\x3e\n    <i class="fa help-icon {{ iconCss }}"\n       [popover]="helper ? popTemplate : comingSoon"\n       [popoverTitle]="helper?.label"\n       [placement]="getPlacement()"\n       [ngClass]="{\'on-dark\': dark }"\n       [container]="container"\n       [outsideClick]="true"\n       (click)="cancelClick($event)">\n    </i>\n  ',styles:[":host{cursor:pointer;line-height:34px;font-size:16px;padding-right:5px}:host .help-icon{color:#d3d3d3}:host .help-icon:hover{color:#3c8dbc}:host .help-icon.on-dark{color:rgba(0,0,0,.3)}:host .help-icon.on-dark:hover{color:#fff}/deep/ popover-container.popover{border-color:#3c8dbc}/deep/ popover-container.popover.top>div.arrow::before{border-top-color:#3c8dbc}/deep/ popover-container.popover.bottom>div.arrow::before{border-bottom-color:#3c8dbc}/deep/ popover-container.popover.left>div.arrow::before{border-left-color:#3c8dbc}/deep/ popover-container.popover.right>div.arrow::before{border-right-color:#3c8dbc}/deep/ popover-container.popover .popover-title{border-bottom-color:#3c8dbc}.edc-popover-container{min-width:150px;line-height:20px;display:flex;flex-direction:column;flex-grow:1}.edc-popover-container .popover-article{font-size:14px;padding-bottom:10px}.edc-popover-container .see-also-item{font-size:15px}.edc-popover-container .see-also-item .article-link{cursor:pointer;color:#0275d8;text-decoration:underline}.edc-popover-container ul{list-style-type:disc}"]}),c("design:paramtypes",[h,o.TranslateService])],e)}(),y=function(){function e(){}return e.prototype.handle=function(e){return""},e}(),b=function(){function e(e,t,n,o,r){void 0===n&&(n=d),void 0===o&&(o=""),void 0===r&&(r=".json"),this.http=e,this.helpService=t,this.defaultLanguage=n,this.prefix=o,this.suffix=r}return e.prototype.getTranslation=function(e){var t=this;void 0===e&&(e=d);var n=this.helpService.isLanguagePresent(e)?e:this.defaultLanguage;return this.http.get(this.prefix+"/"+n+this.suffix).pipe(p.catchError(function(){return t.getTranslationFile(e)}))},e.prototype.getTranslationFile=function(e,t){void 0===t&&(t=this.defaultLanguage);var n=e&&g[e]||t&&g[t]||g[d];return a.of(n)},e}();function m(e,t){var n=t.getDefaultLanguage()||d,o=t.getI18nUrl();return new b(e,t,n,o)}var x=m,k=function(){function e(){}var n;return n=e,e.forRoot=function(e){return{ngModule:n,providers:[h,e.configLoader]}},e=n=s([t.NgModule({imports:[r.CommonModule,l.HttpClientModule,o.TranslateModule.forRoot({loader:{provide:o.TranslateLoader,useFactory:x,deps:[l.HttpClient,h]},missingTranslationHandler:{provide:o.MissingTranslationHandler,useClass:y}}),i.PopoverModule.forRoot()],declarations:[v],providers:[h],exports:[v],entryComponents:[v]})],e)}();e.DEFINED_TRANSLATION_CODES=["en","fr","ru","vi","zh"],e.HelpComponent=v,e.HelpModule=k,e.HelpService=h,e.LANGUAGE_CODES=["en","ar","bg","zh","hr","cs","da","nl","et","fi","fr","de","el","he","hu","is","ga","it","ja","ko","lv","lt","lb","mt","no","fa","pl","pt","ro","ru","sk","sl","es","sv","tr","vi"],e.PopoverConfigurationHandler=u,e.SYS_LANG=d,e.localTranslations=g,e.ɵ0=x,e.ɵa=m,e.ɵb=y,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=edc-popover-ng.umd.min.js.map