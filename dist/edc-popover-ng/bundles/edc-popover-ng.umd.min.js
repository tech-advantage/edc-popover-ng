!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("edc-client-js"),require("edc-popover-js"),require("@angular/common"),require("edc-popover-js/dist/edc-popover.css")):"function"==typeof define&&define.amd?define("edc-popover-ng",["exports","@angular/core","edc-client-js","edc-popover-js","@angular/common","edc-popover-js/dist/edc-popover.css"],t):t((e=e||self)["edc-popover-ng"]={},e.ng.core,e.edcClientJs,e.edcPopoverJs,e.ng.common)}(this,(function(e,t,n,o,r){"use strict";var i=function(){},s=function(){function e(e){this.configurationHandler=e,this.edcClient=new n.EdcClient(e.getDocPath(),e.getHelpPath(),e.getPluginId(),!0,e.getI18nPath())}return e.prototype.getHelp=function(e,t,n,o){var r=n||this.configurationHandler.getPluginId();return this.edcClient.getHelper(e,t,r,o)},e.prototype.getContextUrl=function(e,t,n,o,r){return this.edcClient.getContextWebHelpUrl(e,t,n,o,r)},e.prototype.getDocumentationUrl=function(e){return this.edcClient.getDocumentationWebHelpUrl(e)},e.prototype.getI18nUrl=function(){return this.edcClient.getPopoverI18nUrl()},e.prototype.getPluginId=function(){return this.configurationHandler.getPluginId()},e.prototype.getIcon=function(){return this.configurationHandler.getIcon()||"fa-question-circle-o"},e.prototype.getContainer=function(){return this.configurationHandler.isAppendToBody()?"body":""},e.prototype.getDefaultLanguage=function(){return this.edcClient&&this.edcClient.getDefaultLanguage&&this.edcClient.getDefaultLanguage()||"en"},e.prototype.isLanguagePresent=function(e){return this.edcClient.isLanguagePresent(e)},e.prototype.getPopoverTranslation=function(e){return this.edcClient.getPopoverLabels(e)},e}();s.decorators=[{type:t.Injectable}],s.ctorParameters=function(){return[{type:i}]};var c=(new Map).set("en",{articles:"Need more...",links:"Related topics",iconAlt:"Help",comingSoon:"Contextual help is coming soon.",errors:{failedData:"An error occurred when fetching data !\\nCheck the brick keys provided to the EdcHelp component."},content:null,url:"",exportId:""}).set("fr",{articles:"Plus d'info...",links:"Sujets associés",iconAlt:"Aide",comingSoon:"Aide contextuelle à venir.",errors:{failedData:"Une erreur est survenue lors de la récupération des données !\\nVérifiez les clés de la brique fournies au composant EdcHelp."},content:null,url:"",exportId:""}),a=function(){function e(e){this.helpService=e,this.defaultLanguage="en",this.lang="en"}return e.prototype.getLang=function(){return this.lang},e.prototype.setLang=function(e){this.lang=e},e.prototype.getTranslation=function(e){var t=this;void 0===e&&(e=this.lang);var n=this.helpService.isLanguagePresent(e)?e:this.defaultLanguage;return this.helpService.getPopoverTranslation(n).catch((function(){return t.loadDefaultLabels(e)}))},e.prototype.loadDefaultLabels=function(e,t){void 0===t&&(t=this.defaultLanguage);var n=c.get(e)||c.get(this.defaultLanguage)||c.get("en");return Promise.resolve(n)},e}();a.decorators=[{type:t.Injectable}],a.ctorParameters=function(){return[{type:s}]};var l=function(){function e(e,t){this.helpService=e,this.translationService=t}return e.prototype.buildPopoverConfig=function(e,t,n,o,r,i){var s=this;return void 0===r&&(r="bottom"),this.helpService.getHelp(e,t,n,o).then((function(n){return s.addContent(n,e,t,o)})).then((function(e){return s.addLabels(e)})).then((function(e){return s.addOptions(e,r,i)})).catch((function(e){console.error(e)}))},e.prototype.getIcon=function(){return this.helpService.getIcon()},e.prototype.updateOptions=function(e,t,n){return e?(e.options.placement=t,e.options.customClass=n,e):null},e.prototype.addContent=function(e,t,n,r){var i=new o.PopoverConfig;if(e){var s=e.language;s!==r&&console.warn("Requested language "+r+" could not be loaded,\n           content will be using default language "+e.language+" instead"),this.translationService.setLang(s);var c=e.label,a=e.description,l=e.articles,p=e.links;i.content=Object.assign(new o.PopoverContent,{title:c,description:a,articles:l,links:p}),this.parseUrls(i,t,n,s,e.exportId)}else console.error("Could not load Helper for the key "+t+" and subKey "+n);return i},e.prototype.parseUrls=function(e,t,n,o,r){var i=this;if(e&&e.content){var s=e.content.articles||[],c=e.content.links||[];s.forEach((function(e,s){return e.url=i.helpService.getContextUrl(t,n,o,s,r)})),c.forEach((function(e){return e.url=i.helpService.getDocumentationUrl(e.id)}))}},e.prototype.addLabels=function(e){return this.translationService.getTranslation().then((function(t){return e.labels=t,e})).catch((function(){return e}))},e.prototype.addOptions=function(e,t,n){e.options=Object.assign(new o.PopoverOptions,{placement:t,customClass:n});var r=this.helpService.getContainer();return e.options.appendTo=r&&"body"!==r?"parent":function(){return document.body},e},e}();l.decorators=[{type:t.Injectable}],l.ctorParameters=function(){return[{type:s},{type:a}]};var p=function(){function e(e){this.helpConfigService=e,this.DEFAULT_PLACEMENT="bottom"}return e.prototype.ngOnInit=function(){this.iconCss=this.helpConfigService.getIcon()},e.prototype.ngOnChanges=function(e){["pluginId","mainKey","subKey","lang"].some((function(t){return e[t]}))?this.buildPopoverConfig():["placement","customClass"].some((function(t){return e[t]}))&&(this.config=this.helpConfigService.updateOptions(this.config,this.placement,this.customClass))},e.prototype.getIconClasses=function(){var e=[];return this.iconCss&&e.push(this.iconCss),this.dark&&e.push("on-dark"),e},e.prototype.buildPopoverConfig=function(){var e=this,t=this.placement||this.DEFAULT_PLACEMENT;this.helpConfigService.buildPopoverConfig(this.mainKey,this.subKey,this.pluginId,this.lang,t,this.customClass).then((function(t){e.config=t}))},e}();p.decorators=[{type:t.Component,args:[{selector:"edc-help",template:'\n    <i class="fa help-icon" [ngClass]="this.getIconClasses()" edcHelpPopover [config]="config"></i>\n  ',encapsulation:t.ViewEncapsulation.None,styles:["edc-help{font-size:16px;line-height:34px;padding-right:5px}edc-help .help-icon{color:#d3d3d3;cursor:pointer}edc-help .help-icon:hover{color:#3c8dbc}edc-help .help-icon.on-dark{color:rgba(0,0,0,.3)}edc-help .help-icon.on-dark:hover{color:#fff}"]}]}],p.ctorParameters=function(){return[{type:l}]},p.propDecorators={pluginId:[{type:t.Input}],mainKey:[{type:t.Input}],subKey:[{type:t.Input}],placement:[{type:t.Input}],dark:[{type:t.Input}],lang:[{type:t.Input}],customClass:[{type:t.Input}]};var u=function(){function e(e){this.elementRef=e}return e.prototype.ngOnChanges=function(e){this.loadPopover()},e.prototype.loadPopover=function(){this.config&&this.elementRef&&this.elementRef.nativeElement&&(this.config.target=this.elementRef.nativeElement,this.popoverInstance=new o.Popover(this.config))},e}();u.decorators=[{type:t.Directive,args:[{selector:"[edcHelpPopover]"}]}],u.ctorParameters=function(){return[{type:t.ElementRef}]},u.propDecorators={config:[{type:t.Input}]};var d=function(){function e(){}return e.forRoot=function(t){return{ngModule:e,providers:[s,t.configLoader]}},e}();d.decorators=[{type:t.NgModule,args:[{imports:[r.CommonModule],declarations:[p,u],providers:[s,a,l],exports:[p],entryComponents:[p]}]}],e.DEFINED_TRANSLATION_CODES=["en","fr"],e.HelpComponent=p,e.HelpModule=d,e.HelpService=s,e.LANGUAGE_CODES=["en","ar","bg","zh","hr","cs","da","nl","et","fi","fr","de","el","he","hu","is","ga","it","ja","ko","lv","lt","lb","mt","no","fa","pl","pt","ro","ru","sk","sl","es","sv","tr","vi"],e.PopoverConfigurationHandler=i,e.SYS_LANG="en",e.ɵa=l,e.ɵb=a,e.ɵc=u,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=edc-popover-ng.umd.min.js.map